---
layout: post
title: Free chemistry software - quantum chemistry
date: '2011-12-01T18:30:00.000+01:00'
author: Kenneth Geisshirt
tags:
- MPQC
- computational chemistry
- chemistry
- free software
- IYC
modified_time: '2011-12-02T15:25:12.710+01:00'
thumbnail: http://3.bp.blogspot.com/-zDGZ2reC5MM/Ttez_puIwYI/AAAAAAAAASI/ZyZ-Qe8NpQM/s72-c/Screenshot-MPQC+input.png
blogger_id: tag:blogger.com,1999:blog-1193313609357285189.post-1792601137731844501
blogger_orig_url: https://kenneth.geisshirt.dk/2011/11/free-chemistry-software-quantum.html
---

<span class="Apple-style-span" style="font-size: x-large;">Free chemistry software - quantum chemistry</span><br /><div>In the previous part of the journey into free chemistry software I wrote about molecular mechanics. The molecular mechanics view of a molecular system is a classical mechanical view i.e., the atoms move according to Newton's law.</div><div><br />Quantum mechanics revolutionized the view of the atomic world. The <a href="http://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation">Schrödinger equation</a> is a general model and number of parameters is limited. Solving a Schrödinger equation for an atomic or molecular system is often referred to an <i>ab initio</i>&nbsp;calculation. The word <i>ab initio</i>&nbsp;is latin and can be translated to <i>from the beginning</i>&nbsp;or <i>&nbsp;from first principles</i>.<br /><br />The Schrödinger equaiton - in particular the time-independent equation - can be used to calculate many different properties of chemical substances. Properties like enthalpy and entropy, and heat capacity can calculated as the partition function can be calculated from the solution. Moreover, it is possible to predict data for various spectra (IR, Raman, UV-VIS, etc.). The problem is that it is not possible to find an analytical solution for any non-trivial cases. The solutions to the equation are called wave functions. The <a href="http://en.wikipedia.org/wiki/Copenhagen_interpretation">Copenhagen interpretation</a> of quantum mechanics is that the wave function represents the probably distribution (in space) of the electron.<br /><br />In order to solve the (time independent) Schrödinger equation you must make two important approximations. The first approximation is that the nucleus of the atom is fixed in space, and the Schrödinger equation is reduced to only model the electrons. This approximation is called the <a href="http://en.wikipedia.org/wiki/Born-Oppenheimer_approximation">Born-Oppenheimer approximation</a>. The rationale behind the approximation is that the nucleus of an atom is much heavier that the electrons, and the nucleus moves much slower (this is probably a classical mechanical picture). The second approximation is that the wave function is a sum - or linear combination - of other functions. These functions form a <a href="http://en.wikipedia.org/wiki/Basis_set_(chemistry)">basis set</a>. The basis set is often atom orbitals (solution to the Schrödinger equation for a single atom), and they are often selected in much a manner that they require so few CPU cycles to process as possible. A popular family of basis set is the <a href="http://en.wikipedia.org/wiki/STO-nG_basis_sets">Slater-type orbitals</a>.<br /><br />There are many quantum chemistry packages in the world. From a license perspective, they fall in three groups. The first group is completely proprietary software. You buy the package (maybe the source code is included so you can compile it yourself) and can use it for the set of computers, you have bought a license for. It is not rare to find special pricing schemes for users in the academic world.&nbsp;<a href="http://www.gaussian.com/">Gaussian</a>&nbsp;is a leading software vendor in this field, and a site licence (with UNIX source code) for commercial use is listed as roughly 40,000 USD. This might sound like a high price tag but you must remember that the development of a new drug can easily run in billions. Compared to that, the software is quite cheap - if you are in <a href="http://en.wikipedia.org/wiki/Big_pharma">big pharma</a>. Gaussian does provided must more that just a quantum chemistry calculation engine - it includes various supporting utilities. The group of free software packages is another group with a completely different licensing model. A typical example is <a href="http://www.mpqc.org/">MPQC</a>&nbsp;(Massive Parallel Quantum Chemistry). Released under GNU General Public License it is a truly free software package. The motivation of the developers is to test new algorithm - in particular for the parallellization for using either compute clusters or multicore computers. Somewhere in between you find the third group. Software packages in this group are free to download (if you are in academia or using it for personal purposes) but you are allowed to redistribute the source code or binary. And often you must include a citation to a particular scientific paper if you publish any results based on the software. In this group you find packages like GAMESS (both US and UK versions).&nbsp;</div><div><span class="Apple-style-span" style="font-size: large;"><br /></span><br /><span class="Apple-style-span" style="font-size: large;">Gabedit</span><br />The program <a href="http://gabedit.sourceforge.net/">gabedit</a> provides a uniform interface to many quantum chemistry packages including <a href="http://www.msg.chem.iastate.edu/gamess/">GAMESS-US</a>, <a href="http://www.cfs.dl.ac.uk/">GAMESS-UK</a>, <a href="http://gaussian.com/">Gaussian</a> and <a href="http://www.mpqc.org/">MPQC</a>. The program exists as a binary package for most Linux distributions including Ubuntu Linux and Debian GNU/Linux which makes the installation quite simple.<br /><br /><a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=2519&amp;loc=ec_rcs">1,3,7-trimethylxanthine</a>&nbsp;is a known (legal) psycho-active chemical. It is found naturally in coffee, tea, and soft drinks. The trivial (non systematic) name is <a href="http://en.wikipedia.org/wiki/Caffeine">cafferine</a>. It is a small molecule with an aromatic ring structure.</div><div><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-zDGZ2reC5MM/Ttez_puIwYI/AAAAAAAAASI/ZyZ-Qe8NpQM/s1600/Screenshot-MPQC+input.png" imageanchor="1" style="clear: right; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="313" src="http://3.bp.blogspot.com/-zDGZ2reC5MM/Ttez_puIwYI/AAAAAAAAASI/ZyZ-Qe8NpQM/s320/Screenshot-MPQC+input.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Setting up a calculation in Gabedit</td></tr></tbody></table>You can either draw your molecule or load a file. The structure of many molecules can be found at&nbsp;<a href="http://pubchem.ncbi.nlm.nih.gov/">PubChem</a>&nbsp;or similar services. A 3-dimensional structure of Cafferine can be found at PubChem. A 3-dimensional structure is nothing more that the coordinates of the nuclei of the atoms in the molecule. Using OpenBabel (discussed in previous blog entries), you can convert the PubChem files format to something that Gabedit can understand.<br /><br />Setting up a calculation is simple but you are required to know and understand all the parameters and methods. For a causal user of quantum chemistry software, Gabedit might help you to allow to write configuration files manually, but the program is a thin wrapper only.<br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-SahpvLSCHR0/Tte0D-MT5GI/AAAAAAAAASQ/aUqwA2QNxcE/s1600/Screenshot-Gabedit-1.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="188" src="http://2.bp.blogspot.com/-SahpvLSCHR0/Tte0D-MT5GI/AAAAAAAAASQ/aUqwA2QNxcE/s320/Screenshot-Gabedit-1.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Monitoring a calculation</td></tr></tbody></table>Once you have edited the calculation paramters, you are ready to go. It is possible to monitor the progress of your simulation but beware that quantum chemistry calculation might take hours. Gabedit will use the good old UNIX trick called <a href="http://en.wikipedia.org/wiki/Nohup">nohup</a> so you can come back later. Moreover, Gabedit let you perform the calculation on remote machines. This is useful for long calculations.<br /><br />When the calculation has finished, Gabedit can assist you in analyzing the result. It is only a limited number of analyses offered, and if you need more advanced analysis, you will probably write small scripts and programs to help you.<br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-U2sBpyjkMXQ/Tte1mO42K9I/AAAAAAAAASY/_yEa0gpixQE/s1600/Screenshot.png" imageanchor="1" style="clear: right; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="191" src="http://4.bp.blogspot.com/-U2sBpyjkMXQ/Tte1mO42K9I/AAAAAAAAASY/_yEa0gpixQE/s320/Screenshot.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Analyzing the result of a geometry optimization using Gabedit</td></tr></tbody></table>The really good thing about Gabedit is that it provides a uniform interface to the most common quantum chemistry packages.<br /><br />Other software packages exists e.g., <a href="http://bioinformatics.org/ghemical/ghemical/index.html">Ghemical</a>. Ghemical is fairly tight bound to GNOME, and tries to solve all needs for computational chemistry in one packages. The latest version of Ghemical is recent (October 2011).<br /><br /><br /><span class="Apple-style-span" style="font-size: large;">MPQC</span><br /><a href="http://www.mpqc.org/">MPQC</a> is a pure free software project which provides an <i>ab initio</i>&nbsp;package. It is designed to run in multicore or cluster environments i.e., in massive parallel environment. Ubuntu and Debian packages exists. Currently, two packages exist: the core program and supporting utilities. Even an Emacs mode can be found for editing the configuration files. The main mode of operation is that the user writes a configuration or input file and run the program from the command-line or through a <a href="http://en.wikipedia.org/wiki/Batch-queuing_system">batch system</a>. The OpenBabel conversion utility supports MPQC and can write raw input files from structure file formats. This simplifies the usage a lot in the learning period.<br /><br />In order to test MPQC, I have prepared an input file using Caffeine. As MPQC supports the calculation of thermodynamics properties (non-electronic enthalpy and entropy), my test input file will perform this analysis after the <a href="http://en.wikipedia.org/wiki/Geometry_optimization">geometry optimization</a>&nbsp;using the STO-6G basis set and a Hartree-Fock method. The <a href="http://en.wikipedia.org/wiki/Hartree%E2%80%93Fock_method">Hartree-Fock method</a> is only calculating the ground level state, and the thermodynamics will be somewhat inaccurate.<br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; margin-left: 1em; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-1a2miNVmk5Q/Tte7rhMfIxI/AAAAAAAAASg/StKpEauKAzU/s1600/mpqc-speedup.png" imageanchor="1" style="clear: right; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://1.bp.blogspot.com/-1a2miNVmk5Q/Tte7rhMfIxI/AAAAAAAAASg/StKpEauKAzU/s320/mpqc-speedup.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">MPQC/Linux Speed-up</td></tr></tbody></table>As MPQC is a parallel calculation program, it is worth analyzing the speed-up i.e., how well does scale as the number of core/CPUs increases. MPQC is parallellized using either <a href="http://www.open-mpi.org/">MPI</a>, SysV shared memory and Posix threads.<br /><br />Running on multiple cores is simple with MPQC. You can specify the number of threads on the command-line. For a 4-thread calculation, the command-line is: <span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">mpqc&nbsp;</span><span class="Apple-style-span" style="background-color: white; font-size: 14px; white-space: pre;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">-threadgrp "&lt;PthreadThreadGrp&gt;:(num_threads = 4) -o caffeine.out caffeine.in</span><span class="Apple-style-span" style="font-family: monospace;"> </span><span class="Apple-style-span" style="font-family: inherit;">where </span><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">caffeine.in</span><span class="Apple-style-span" style="font-family: inherit;"> is the input file and the output is found in </span><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">caffeine.out</span><span class="Apple-style-span" style="font-family: inherit;">.</span></span><br />As I have access to a <a href="http://ark.intel.com/products/41316/Intel-Core-i7-860-Processor-(8M-Cache-2_80-GHz)">hyperthreaded quad-core</a>&nbsp;computer, I have tested the Posix thread parallellization (please remember that Linux has a highly optimized Posix thread implementation).<br /><br />The result of my simple benchmark shows that hyperthreading is not a good idea in heavy computing environment - notice that the speed-up levels off at four cores. The reason is probably that the threads are competing for a limited resource: the floating-point units. A calculation of the Caffeine molecule took about 8 hours using 4 Posix threads, and this only calculated the ground state using the STO-6G basis set.<br /><br /><span class="Apple-style-span" style="font-size: large;">Summary</span><br />In general it is possible to carry out quantum chemistry calculation using free software if you can live without a fancy user interface. If you do many calculations, you might be happy to know that you can modify and extend the source code. For a causal computational chemist (maybe an organic chemist predicting spectras), free chemistry software might not be the solution yet.</div>